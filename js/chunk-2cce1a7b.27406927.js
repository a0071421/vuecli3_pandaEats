(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cce1a7b"],{1276:function(t,e,a){"use strict";var n=a("d784"),o=a("44e7"),s=a("825a"),i=a("1d80"),l=a("4840"),c=a("8aa5"),r=a("50c4"),u=a("14c3"),d=a("9263"),p=a("d039"),m=[].push,h=Math.min,g=4294967295,v=!p((function(){return!RegExp(g,"y")}));n("split",2,(function(t,e,a){var n;return n="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var n=String(i(this)),s=void 0===a?g:a>>>0;if(0===s)return[];if(void 0===t)return[n];if(!o(t))return e.call(n,t,s);var l,c,r,u=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,v=new RegExp(t.source,p+"g");while(l=d.call(v,n)){if(c=v.lastIndex,c>h&&(u.push(n.slice(h,l.index)),l.length>1&&l.index<n.length&&m.apply(u,l.slice(1)),r=l[0].length,h=c,u.length>=s))break;v.lastIndex===l.index&&v.lastIndex++}return h===n.length?!r&&v.test("")||u.push(""):u.push(n.slice(h)),u.length>s?u.slice(0,s):u}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:e.call(this,t,a)}:e,[function(e,a){var o=i(this),s=void 0==e?void 0:e[t];return void 0!==s?s.call(e,o,a):n.call(String(o),e,a)},function(t,o){var i=a(n,t,this,o,n!==e);if(i.done)return i.value;var d=s(t),p=String(this),m=l(d,RegExp),_=d.unicode,b=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(v?"y":"g"),f=new m(v?d:"^(?:"+d.source+")",b),C=void 0===o?g:o>>>0;if(0===C)return[];if(0===p.length)return null===u(f,p)?[p]:[];var x=0,w=0,y=[];while(w<p.length){f.lastIndex=v?w:0;var $,k=u(f,v?p:p.slice(w));if(null===k||($=h(r(f.lastIndex+(v?0:w)),p.length))===x)w=c(p,w,_);else{if(y.push(p.slice(x,w)),y.length===C)return y;for(var M=1;M<=k.length-1;M++)if(y.push(k[M]),y.length===C)return y;w=x=$}}return y.push(p.slice(x)),y}]}),!v)},1799:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.paginationInfo?a("nav",{staticClass:"mt-3 d-flex justify-content-center",attrs:{"aria-label":"Page navigation example"}},[a("ul",{staticClass:"pagination"},[a("li",{staticClass:"page-item",class:{disabled:!t.paginationInfo.has_pre}},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Previous"},on:{click:function(e){return e.preventDefault(),t.getProducts(t.paginationInfo.current_page-1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("«")])])]),t._l(t.paginationInfo.total_pages,(function(e){return a("li",{key:e,staticClass:"page-item",class:{active:t.paginationInfo.current_page===e}},[a("a",{staticClass:"page-link",attrs:{href:"#"},on:{click:function(a){return a.preventDefault(),t.getProducts(e)}}},[t._v(t._s(e))])])})),a("li",{staticClass:"page-item",class:{disabled:!t.paginationInfo.has_next}},[a("a",{staticClass:"page-link",attrs:{href:"#","aria-label":"Next"},on:{click:function(e){return e.preventDefault(),t.getProducts(t.paginationInfo.current_page+1)}}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("»")])])])],2)]):t._e()},o=[],s={name:"pagination",props:["paginationInfo"],data:function(){return{}},methods:{getProducts:function(t){this.$emit("changePage",t)}}},i=s,l=a("2877"),c=Object(l["a"])(i,n,o,!1,null,null,null);e["a"]=c.exports},"44e7":function(t,e,a){var n=a("861d"),o=a("c6b6"),s=a("b622"),i=s("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==o(t))}},"99af":function(t,e,a){"use strict";var n=a("23e7"),o=a("d039"),s=a("e8b5"),i=a("861d"),l=a("7b0b"),c=a("50c4"),r=a("8418"),u=a("65f0"),d=a("1dde"),p=a("b622"),m=a("2d00"),h=p("isConcatSpreadable"),g=9007199254740991,v="Maximum allowed index exceeded",_=m>=51||!o((function(){var t=[];return t[h]=!1,t.concat()[0]!==t})),b=d("concat"),f=function(t){if(!i(t))return!1;var e=t[h];return void 0!==e?!!e:s(t)},C=!_||!b;n({target:"Array",proto:!0,forced:C},{concat:function(t){var e,a,n,o,s,i=l(this),d=u(i,0),p=0;for(e=-1,n=arguments.length;e<n;e++)if(s=-1===e?i:arguments[e],f(s)){if(o=c(s.length),p+o>g)throw TypeError(v);for(a=0;a<o;a++,p++)a in s&&r(d,p,s[a])}else{if(p>=g)throw TypeError(v);r(d,p++,s)}return d.length=p,d}})},d0a3:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("loading",{attrs:{active:t.isLoading},on:{"update:active":function(e){t.isLoading=e}}}),a("div",{staticClass:"d-flex justify-content-end mt-4",class:{"justify-content-between":t.coupons.length}},[t.coupons.length?a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:function(e){return t.openModal("deleteAll")}}},[t._v(" 刪除所有優惠券 ")]):t._e(),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.openModal("new")}}},[t._v(" 建立新的優惠券 ")])]),t.coupons.length?a("div",{staticClass:"custom-table-width"},[a("table",{staticClass:"table custom-table mt-4"},[t._m(0),a("tbody",{staticClass:"custom-table-tbody"},t._l(t.coupons,(function(e){return a("tr",{key:e.id},[a("td",[t._v(t._s(e.title))]),a("td",[t._v(t._s(e.percent)+"%")]),a("td",[t._v(t._s(t._f("date")(e.due_date)))]),e.is_enabled?a("td",{staticClass:"text-success"},[t._v("啟用")]):a("td",{staticClass:"text-danger"},[t._v("不啟用")]),a("td",[a("button",{staticClass:"btn btn-sm btn-outline-primary",attrs:{type:"button"},on:{click:function(a){return t.openModal("edit",e)}}},[t._v(" 編輯 ")]),a("button",{staticClass:"btn btn-sm btn-outline-danger",attrs:{type:"button"},on:{click:function(a){return t.openModal("delete",e)}}},[t._v(" 刪除 ")])])])})),0)]),a("Pagination",{attrs:{"pagination-info":t.pagination},on:{changePage:t.getCoupons}})],1):t._e(),a("div",{staticClass:"modal fade",attrs:{id:"couponModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg"},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header bg-primary text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},["new"===t.option?a("span",[t._v(" 建立新的優惠券 ")]):t._e(),"edit"===t.option?a("span",[t._v(" 編輯優惠券 ")]):t._e()]),t._m(1)]),a("div",{staticClass:"modal-body"},[a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"title"}},[t._v("標題")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.temp_coupon.title,expression:"temp_coupon.title"}],staticClass:"form-control",attrs:{type:"text",id:"title"},domProps:{value:t.temp_coupon.title},on:{input:function(e){e.target.composing||t.$set(t.temp_coupon,"title",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"code"}},[t._v("優惠碼")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.temp_coupon.code,expression:"temp_coupon.code"}],staticClass:"form-control",attrs:{type:"text",id:"code"},domProps:{value:t.temp_coupon.code},on:{input:function(e){e.target.composing||t.$set(t.temp_coupon,"code",e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"expired"}},[t._v("到期日")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.due_date,expression:"due_date"}],staticClass:"form-control",attrs:{type:"date",id:"expired"},domProps:{value:t.due_date},on:{input:function(e){e.target.composing||(t.due_date=e.target.value)}}})]),a("div",{staticClass:"form-group"},[a("label",{attrs:{for:"discount"}},[t._v("折扣百分比")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.temp_coupon.percent,expression:"temp_coupon.percent"}],staticClass:"form-control",attrs:{type:"number",id:"discount",min:"1",max:"100"},domProps:{value:t.temp_coupon.percent},on:{input:function(e){e.target.composing||t.$set(t.temp_coupon,"percent",e.target.value)}}})]),a("div",{staticClass:"form-group form-check"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.temp_coupon.is_enabled,expression:"temp_coupon.is_enabled"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"is_enabled"},domProps:{checked:Array.isArray(t.temp_coupon.is_enabled)?t._i(t.temp_coupon.is_enabled,null)>-1:t.temp_coupon.is_enabled},on:{change:function(e){var a=t.temp_coupon.is_enabled,n=e.target,o=!!n.checked;if(Array.isArray(a)){var s=null,i=t._i(a,s);n.checked?i<0&&t.$set(t.temp_coupon,"is_enabled",a.concat([s])):i>-1&&t.$set(t.temp_coupon,"is_enabled",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.temp_coupon,"is_enabled",o)}}}),a("label",{staticClass:"form-check-label",attrs:{for:"is_enabled"}},[t._v("是否啟用")])])]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-danger",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),a("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button",id:"confirm"},on:{click:t.updateCoupon}},["new"===t.option?a("span",[t._v(" 新增 ")]):t._e(),"edit"===t.option?a("span",[t._v(" 更新 ")]):t._e()])])])])]),a("div",{staticClass:"modal fade",attrs:{id:"delCouponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModaßlLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content border-0"},[t._m(2),a("div",{staticClass:"modal-body"},[t._v(" 是否刪除 "),"delete"===t.option?a("strong",{staticClass:"h4 text-highlight word-wrap-break"},[t._v(t._s(t.temp_coupon.title))]):t._e(),"deleteAll"===t.option?a("strong",{staticClass:"h4 text-highlight word-wrap-break"},[t._v("所有")]):t._e(),t._v(" 優惠券(刪除後將無法恢復)。 ")]),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-outline-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" 取消 ")]),a("button",{staticClass:"btn btn-danger",attrs:{type:"button"},on:{click:t.deleteCoupon}},[t._v(" 確認刪除 ")])])])])])],1)},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",{staticClass:"custom-table-thead"},[a("th",{staticClass:"text-nowrap"},[t._v("名稱")]),a("th",{staticClass:"text-nowrap"},[t._v("折扣百分比")]),a("th",{staticClass:"text-nowrap w-20"},[t._v("到期日")]),a("th",{staticClass:"text-nowrap"},[t._v("是否啟用")]),a("th",{staticClass:"text-nowrap"},[t._v("編輯")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header bg-danger text-white"},[a("h5",{staticClass:"modal-title",attrs:{id:"exampleModalLabel"}},[a("span",[t._v("刪除優惠券")])]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])])])}],s=a("5530"),i=(a("99af"),a("1276"),a("ac1f"),a("159b"),a("1157")),l=a.n(i),c=a("1799"),r={name:"coupons",data:function(){return{coupons:[],temp_coupon:{},isLoading:!1,option:"",due_date:new Date,pagination:{}}},methods:{getCoupons:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this;e.isLoading=!0;var a="".concat("https://vue-course-api.hexschool.io","/api/").concat("neil0907","/admin/coupons?page=").concat(t);e.$http.get(a).then((function(t){t.data.success?(e.coupons=t.data.coupons,e.pagination=t.data.pagination):(e.$bus.$emit("message:push",t.data.message,"danger"),e.$router.push("/login")),e.isLoading=!1}))},openModal:function(t,e){this.option=t,"new"===t?(this.temp_coupon={title:"",is_enabled:!1,percent:100,due_date:0,code:""},l()("#couponModal").modal("show")):"edit"===t?(this.temp_coupon=Object(s["a"])({},e),this.due_date=new Date(1e3*this.temp_coupon.due_date).toISOString().split("T")[0],l()("#couponModal").modal("show")):(this.temp_coupon=Object(s["a"])({},e),l()("#delCouponModal").modal("show"))},updateCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("neil0907","/admin/coupon"),a="post";t.isLoading=!0;var n=Object(s["a"])({},t.temp_coupon);n.due_date=Math.floor(new Date(t.due_date)/1e3),"edit"===t.option&&(e="".concat("https://vue-course-api.hexschool.io","/api/").concat("neil0907","/admin/coupon/").concat(t.temp_coupon.id),a="put"),t.$http[a](e,{data:Object(s["a"])({},n)}).then((function(e){l()("#couponModal").modal("hide"),e.data.success?(t.$bus.$emit("message:push","".concat("new"===t.option?"新增":"更新"," ").concat(t.temp_coupon.title," 成功"),"success"),t.getCoupons()):t.$bus.$emit("message:push","新增失敗","danger")}))},deleteCoupon:function(){var t=this,e="".concat("https://vue-course-api.hexschool.io","/api/").concat("neil0907","/admin/coupon/").concat(t.temp_coupon.id);t.isLoading=!0,"deleteAll"===t.option?t.coupons.forEach((function(a,n){e="".concat("https://vue-course-api.hexschool.io","/api/").concat("neil0907","/admin/coupon/").concat(a.id),t.$http.delete(e).then((function(e){l()("#delCouponModal").modal("hide"),e.data.success?n===t.coupons.length-1&&(t.$bus.$emit("message:push","已刪除所有優惠券"),t.getCoupons()):t.$bus.$emit("message:push","刪除失敗","danger")}))})):t.$http.delete(e).then((function(e){l()("#delCouponModal").modal("hide"),e.data.success?(t.$bus.$emit("message:push","已刪除 ".concat(t.temp_coupon.title," 優惠券")),t.getCoupons()):t.$bus.$emit("message:push","刪除失敗","danger")}))}},created:function(){this.getCoupons()},components:{Pagination:c["a"]}},u=r,d=a("2877"),p=Object(d["a"])(u,n,o,!1,null,null,null);e["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2cce1a7b.27406927.js.map